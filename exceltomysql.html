<html>
  <head>
    <meta charSet="utf-8"/>
    <title>stabur.github.io | Экспорт таблицы MS Excel в дазу данных MySQL (ExcelToMySql)</title>
  </head>
<body bgcolor="000000" text="ffffff">
  <h1 align="center">stabur.github.io</h1>
  <h2 align="center">Экспорт таблицы MS Excel в дазу данных MySQL (ExcelToMySql)</h2>
  <center><table border="0" width="80%">
    <tr>
        <td>&nbsp;&nbsp;&nbsp;<b>"# ExcelToMySql"</b> Программа написанная на Python (необходимые решения для реализации см. в описании),
            представляет из себя GUI графический интерфейс под Windows, позволяющий переносить данные таблицы MS Excel (.xlsx) 
            в базу данных MySQL.
        </td>
    </tr>
    <tr>
        <td>&nbsp;&nbsp;&nbsp;<b>Принцип работы.</b><br />&nbsp;После запуска программы, необходимо корректно заполнить все поля
            для подключения к базе данных MySQL.
        </td>
    </tr>
    <tr>
        <td align="center">
            <img src="./img/exceltomysql1.jpg">
        </td>
    </tr>
    <tr>
        <td>
            &nbsp;Здесь в поле "Адрес ssh сервера" указываеться IP адрес ssh-сервера на котором расположена база данных MySQL,
            в моём случае, тестировал в локальной сети (сервером служил ПК с Linux Debian 12 ssh, apache и mysql), указываем порт
            (по умолчанию 22), логин пароль от ssh-сервера, внутренний адрес mysql-сервера (по умолчанию 127.0.0.1) и порт 
            (по умолчанию 3306). Нажимаем кнопку "Test SSH-Server". При удачном соединении в верхней части программы появиться 
            надпись "Соединение c SSH-сервером установленно!", при неудачной "Соединение c SSH-сервером НЕ установленно!",
            необходимо проверить вышевнесенные данные.
        </td>
    </tr>
    <tr>
        <td align="center">
            <img src="./img/exceltomysql2.jpg">&nbsp;<img src="./img/exceltomysql3.jpg">
        </td>
    </tr>
    <tr>
        <td>
            &nbsp;Если с ssh сервером соединение состоялось, переходим к проверки подключения к самой базе данных MySQL.
            Хост (по умолчанию localhost), логин, пароль, и название дазы данных. Также проверяем, нажимаем на кнопку 
            "Проверить соединение с БД". В результате удачного подключения появится "Соединение c MySql установленно!", 
            иначе "Соединение c MySql НЕ установленно!".
        </td>
    </tr>
    <tr>
        <td align="center">
            <img src="./img/exceltomysql4.jpg">&nbsp;<img src="./img/exceltomysql5.jpg">
        </td>
    </tr>
    <tr>
        <td>
            &nbsp;Все тесты подключения прошли успешно, теперь можно приклеплять excel-файл формата .xlsx нажатием кнопки 
            "Прикрепить файл" выходит окно, где необходимо выбрать нужный файл. В результате должно получиться следующее:
        </td>
    </tr>
    <tr>
        <td align="center">
            <img src="./img/exceltomysql6.jpg">
        </td>
    </tr>
    <tr>
        <td>
            &nbsp;Теперь нажимаем кнопку "Создать" и ждем завершения. Время ожидания зависит от объема данных. Если все 
            сделанно верно, должно получится следующие:  
        </td>
    </tr>
    <tr>
        <td align="center">
            <img src="./img/exceltomysql7.jpg">&nbsp;<img src="./img/exceltomysql8.jpg">&nbsp;<img src="./img/exceltomysql9.jpg">
        </td>
    </tr>
    <tr>
        <td>
            &nbsp;Пока не доработан стстус загрузки файла, есть не доработки с таблицами и колоноками в таблице, 
            например, если таблица в базе mysql уже существует и количество и наименование колонок соответствует, 
            то (тоже пока недоработан update запрос) происходит добавление к существующим записям. В процессе планирую 
            сделать гибкую систему добавления, с выбором функций, либо полностью удалить содержимое таблицы и заново 
            создать (например, добавились новые колонки), либо простое обновление данных с добавлением (если есть) 
            новых позиций.<br />
            &nbsp;При подключении к удаленному серверу используется SSHTunnel. Ни каких логов и отправки ваших данных 
            2-м и 3-м лицам не предусмотрено.<br />
            &nbsp;Транслитирует название файла (оно же наименование таблицы) и колонок. Транслит производит файл 
            translit.py, необходим для размещения в одной директории с main.py. Используется экранизация спец. символов.<br />
            &nbsp;Переносит тело документа один в один. Если вы используете не совсем стандартный прайс-лист или перечень 
            товара, сотрудников и т.д. и т.п. (ну, например у вас на одну позицию используются несколько строк в разных 
            колонках), вылетит ошибка. Работаю над этим.
        </td>
    </tr>
    <tr>
      <td>&nbsp;Создавалось и тестировалось на Win10 64x, Python 3.10.4 (и на Python 3.12.2).<br />
        Потребуется установить:<br />
        MySQLdb<br />pip install mysqlclient<br />
        PyQt5<br />pip install PyQt5<br />
        Pandas<br />pip install pandas<br />
        Numpy<br />pip install numpy<br />
        SSHTunnel<br />pip install sshtunnel<br />
        re<br />pip install re<br />
        Openpyxl<br />pip install openpyxl<br />
        PyArrow<br />pip install PyArrow<br />
        &nbsp;Сервером служил домашний компьютер с Linux Debian 12, Apache/2.4.57, mysql Ver 15.1 Distrib 10.11.4-MariaDB, 
        OpenSSH_9.2p1 Debian-2+deb12u2, OpenSSL 3.0.11 19 Sep 2023
      </td>
    </tr>
  </table></center>
</body>
</html>
